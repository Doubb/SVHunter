import sys, argparse
import re
EXP_REX = re.compile(r'([a-zA-Z_]*)\s::\s([a-zA-Z_]*)\s->\s([a-zA-Z_]*)\s=\s([a-zA-Z_]*)')

def log_to_cmd(logFile):
	f = open(logFile, 'r')
	log = f.read()
	info = EXP_REX.findall(log)
	if not info or len(info[0]) != 4:
		sys.exit("Error: Conf Format Wrong")
	else:
		info = info[0]
	exp_info = {}
	field = ["proto","msg","field","content"]
	for i in range(len(field)):
		exp_info[field[i]] = info[i]
	return exp_info

def parse_command():
	parser = argparse.ArgumentParser()
	parser.add_argument("-l", dest='log', help="Path of Exploit Conf")
	args = parser.parse_args()
	if args.log:
		return log_to_cmd(args.log)
	else:
		sys.exit("Error: Please specify a Conf")

 

if __name__ == '__main__':
	exp_info = parse_command()
	print exp_info